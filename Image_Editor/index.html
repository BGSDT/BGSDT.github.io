<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>È´òÁ∫ßÂõæÂÉèÁºñËæëÂô®</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/mobile.css">
</head>

<body>
    <!-- ÂêØÂä®ÁîªÈù¢ -->
    <div id="splash-screen">
        <svg class="splash-logo" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M60 0L115.98 30V90L60 120L4.02 90V30L60 0Z" fill="#4A90E2"/>
            <path d="M60 20L100 40V80L60 100L20 80V40L60 20Z" fill="#50E3C2"/>
            <path d="M60 40L80 50V70L60 80L40 70V50L60 40Z" fill="white"/>
        </svg>
        <div class="loading-bar">
            <div class="loading-progress"></div>
        </div>
    </div>

    <!-- ‰∏ªÁïåÈù¢ -->
    <div class="header">
        <div class="app-title">PhotoshopÈ£éÊ†ºÁºñËæëÂô®</div>
        <div style="margin-left: auto; display: flex; gap: 10px;">
            <button class="btn-secondary" onclick="onHomeButtonClick()" style="padding: 4px 8px; font-size: 12px;">È¶ñÈ°µ</button>
            <button onclick="showExportScreen()" style="padding: 4px 8px; font-size: 12px;">ÂØºÂá∫</button>
        </div>
    </div>

    <div class="main-container">
        <!-- Â∑¶‰æßÂ∑•ÂÖ∑Ê†è -->
        <div class="toolbar">
            <div class="tool-button active" title="ÈÄâÊã©Â∑•ÂÖ∑" onclick="setActiveTool('select')" data-tool="select">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L19 21L12 17L5 21L12 2Z"></path>
                </svg>
            </div>
            <div class="tool-separator"></div>
            <div class="tool-button" title="ÊñáÂ≠óÂ∑•ÂÖ∑" onclick="setActiveTool('text'); switchPanel('properties'); document.getElementById('text-properties').scrollIntoView();" data-tool="text">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 20L20 20"></path>
                    <path d="M12 4L12 20"></path>
                </svg>
            </div>
            <div class="tool-button" title="Áü©ÂΩ¢Â∑•ÂÖ∑" onclick="setActiveTool('rect'); switchPanel('properties'); document.getElementById('shape-properties').scrollIntoView();" data-tool="rect">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2"></rect>
                </svg>
            </div>
            <div class="tool-button" title="ÂúÜÂΩ¢Â∑•ÂÖ∑" onclick="setActiveTool('circle'); switchPanel('properties'); document.getElementById('shape-properties').scrollIntoView();" data-tool="circle">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                </svg>
            </div>
            <div class="tool-button" title="‰∏âËßíÂΩ¢Â∑•ÂÖ∑" onclick="setActiveTool('triangle'); switchPanel('properties'); document.getElementById('shape-properties').scrollIntoView();" data-tool="triangle">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                </svg>
            </div>
            <div class="tool-separator"></div>
            <div class="tool-button" title="ËÉåÊôØÂõæÁâá" onclick="document.getElementById('set-background-input').click()" data-tool="bg-image">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <path d="M21 15l-3.5-3.5L12 18l-2-2-5 5"></path>
                </svg>
            </div>
            <div class="tool-button" title="ÊèíÂÖ•ÂõæÁâá" onclick="document.getElementById('insert-image-input').click()" data-tool="insert-image">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7"></path>
                    <line x1="16" y1="5" x2="22" y2="5"></line>
                    <line x1="19" y1="2" x2="19" y2="8"></line>
                    <circle cx="9" cy="9" r="2"></circle>
                    <path d="M21 15l-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path>
                </svg>
            </div>
        </div>

        <!-- ÁîªÂ∏ÉÂå∫Âüü -->
        <div class="canvas-wrapper">
            <div class="canvas-container">
                <canvas id="main-canvas"></canvas>
            </div>
        </div>

        <!-- Âè≥‰æßÈù¢Êùø -->
        <div class="right-panel">
            <div class="panel-tabs">
                <div class="panel-tab active" onclick="switchPanel('properties')" data-panel="properties">Â±ûÊÄß</div>
                <div class="panel-tab" onclick="switchPanel('layers')" data-panel="layers">ÂõæÂ±Ç</div>
            </div>
            
            <div class="panel-content">
                <!-- Â±ûÊÄßÈù¢Êùø -->
                <div id="properties-content" class="mobile-panel">
                    <div class="panel-section" id="selection-properties">
                        <div class="panel-title">ÈÄâÊã©Â±ûÊÄß</div>
                        <div class="form-group">
                            <label>‰ΩçÁΩÆ X</label>
                            <input type="number" id="pos-x" onchange="updateSelectedObject()">
                        </div>
                        <div class="form-group">
                            <label>‰ΩçÁΩÆ Y</label>
                            <input type="number" id="pos-y" onchange="updateSelectedObject()">
                        </div>
                        <div class="form-group">
                            <label>ÂÆΩÂ∫¶</label>
                            <input type="number" id="width" onchange="updateSelectedObject()">
                        </div>
                        <div class="form-group">
                            <label>È´òÂ∫¶</label>
                            <input type="number" id="height" onchange="updateSelectedObject()">
                        </div>
                        <div class="form-group">
                            <label>ÊóãËΩ¨</label>
                            <input type="number" id="rotation" min="0" max="360" onchange="updateSelectedObject()">
                        </div>
                        <div class="form-group">
                            <label>ÈÄèÊòéÂ∫¶</label>
                            <input type="number" id="opacity" min="0" max="1" step="0.1" value="1" onchange="updateSelectedObject()">
                        </div>
                        <div class="form-group">
                            <label>È¢úËâ≤</label>
                            <input type="color" id="object-color" value="#000000" onchange="updateSelectedObject()">
                        </div>
                    </div>

                    <div class="panel-section" id="text-properties">
                        <div class="panel-title">ÊñáÂ≠óÂ±ûÊÄß</div>
                        <div class="form-group">
                            <label>ÊñáÂ≠óÂÜÖÂÆπ</label>
                            <input type="text" id="text-content" placeholder="ËæìÂÖ•ÊñáÂ≠ó">
                        </div>
                        <div class="form-group">
                            <label>Â≠ó‰Ωì</label>
                            <select id="font-family">
                                <option value="Arial">Arial</option>
                                <option value="Times New Roman">Times New Roman</option>
                                <option value="Verdana">Verdana</option>
                                <option value="Courier New">Courier New</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Â≠óÂè∑</label>
                            <input type="number" id="font-size" value="24" min="8" max="120">
                        </div>
                        <div class="form-group">
                            <label>È¢úËâ≤</label>
                            <input type="color" id="text-color" value="#ffffff">
                        </div>
                        <button onclick="addText()">Ê∑ªÂä†ÊñáÂ≠ó</button>
                    </div>

                    <div class="panel-section" id="shape-properties">
                        <div class="panel-title">ÂΩ¢Áä∂Â±ûÊÄß</div>
                        <div class="form-group">
                            <label>ÂΩ¢Áä∂Á±ªÂûã</label>
                            <select id="shape-type">
                                <option value="rect">Áü©ÂΩ¢</option>
                                <option value="circle">ÂúÜÂΩ¢</option>
                                <option value="triangle">‰∏âËßíÂΩ¢</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ÂÆΩÂ∫¶</label>
                            <input type="number" id="shape-width" value="100" min="10">
                        </div>
                        <div class="form-group">
                            <label>È´òÂ∫¶</label>
                            <input type="number" id="shape-height" value="100" min="10">
                        </div>
                        <div class="form-group">
                            <label>Â°´ÂÖÖËâ≤</label>
                            <input type="color" id="shape-fill" value="#4a90e2">
                        </div>
                        <button onclick="addShape()">Ê∑ªÂä†ÂΩ¢Áä∂</button>
                    </div>
                </div>
                
                <!-- ÂõæÂ±ÇÈù¢Êùø -->
                <div id="layers-content" class="mobile-panel">
                    <div class="panel-section">
                        <div class="panel-title">ÂõæÂ±ÇÁÆ°ÁêÜ</div>
                        <div class="layers-container" id="layers-list">
                            <!-- ÂõæÂ±ÇÂàóË°®Â∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                        </div>
                        <div class="layer-actions">
                            <button onclick="moveLayerUp()">‰∏äÁßª</button>
                            <button onclick="moveLayerDown()">‰∏ãÁßª</button>
                            <button onclick="deleteSelectedLayer()" class="btn-secondary">Âà†Èô§</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div>PhotoshopÈ£éÊ†ºÁºñËæëÂô® v1.0</div>
    </div>

    <!-- ÂºÄÂßãÁïåÈù¢ -->
    <div id="start-screen">
        <div class="start-container">
            <h1 style="margin-bottom: 20px;">‚ú® È´òÁ∫ßÂõæÂÉèÁºñËæëÂô®</h1>
            <button onclick="startEditing()" style="margin-bottom: 15px; padding: 12px 24px;">
                ÂºÄÂßãÁºñËæë
            </button>
            <button onclick="document.getElementById('ped-input').click()" style="padding: 12px 24px;">
                ÂØºÂÖ•PEDÊñá‰ª∂
            </button>
        </div>
    </div>

    <!-- ÂØºÂá∫ÁïåÈù¢ -->
    <div id="export-screen">
        <div class="export-container">
            <h2 style="margin-bottom: 20px;">ÂØºÂá∫ËÆæÁΩÆ</h2>
            <div class="form-group">
                <label>ÂØºÂá∫Ê†ºÂºè</label>
                <select id="export-format" style="margin-bottom: 15px;">
                    <option value="png">PNG (ÈÄèÊòéËÉåÊôØ)</option>
                    <option value="jpg">JPG (È´òË¥®Èáè)</option>
                    <option value="ped">PED (‰∏ìÊúâÁºñËæëÊñá‰ª∂)</option>
                </select>
            </div>
            <div style="display: flex; gap: 10px; justify-content: center;">
                <button onclick="exportImage()" style="flex: 1;">Á°ÆËÆ§ÂØºÂá∫</button>
                <button onclick="hideExportScreen()" class="btn-secondary" style="flex: 1;">ÂèñÊ∂à</button>
            </div>
        </div>
    </div>

    <!-- ÈöêËóèÁöÑÊñá‰ª∂ËæìÂÖ•Êéß‰ª∂ -->
    <input type="file" id="set-background-input" accept="image/*" style="display: none;">
    <input type="file" id="insert-image-input" accept="image/*" multiple style="display: none;">
    <input type="file" id="ped-input" accept=".ped" style="display: none;">
    <a id="download-link" style="display: none;"></a>
    
    <!-- ÁßªÂä®Á´ØÂØºËà™Ê†è -->
    <div class="mobile-nav">
        <div class="mobile-nav-button" onclick="toggleMobilePanel('toolbar')">
            <div class="mobile-nav-icon">üîß</div>
            <div>Â∑•ÂÖ∑</div>
        </div>
        <div class="mobile-nav-button" onclick="toggleMobilePanel('properties-content')">
            <div class="mobile-nav-icon">‚öôÔ∏è</div>
            <div>Â±ûÊÄß</div>
        </div>
        <div class="mobile-nav-button" onclick="toggleMobilePanel('layers-content'); updateLayersPanel();">
            <div class="mobile-nav-icon">üìë</div>
            <div>ÂõæÂ±Ç</div>
        </div>
        <div class="mobile-nav-button" onclick="showExportScreen()">
            <div class="mobile-nav-icon">üì§</div>
            <div>ÂØºÂá∫</div>
        </div>
    </div>
    
    <script src="js/index.js"></script>
</body>

</html>
